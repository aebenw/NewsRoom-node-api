{"version":3,"sources":["../../../server/models/classes/Source.js"],"names":["SourceClass","addArticle","article","articles","push","save","then","e","findOrCreate","source","found","findOne","id","_doc","image","url","create","img","findOrCreateWithCat","category","cat","Category","findOrCreateByName","foundSource","Source","_id","sources"],"mappings":";;;;;;;AAAA;;AACA;;AAGA,MAAMA,WAAN,CAAkB;AAEhBC,EAAAA,UAAU,CAACC,OAAD,EAAS;AACjB,SAAKC,QAAL,CAAcC,IAAd,CAAmBF,OAAnB;AACA,SAAKG,IAAL,GAAYC,IAAZ,CAAiB,IAAjB,EAAuBC,CAAC,IAAIA,CAA5B;AACD;;AAED,eAAaC,YAAb,CAA0BC,MAA1B,EAAiC;AAC/B,QAAIC,KAAK,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACC,MAAAA,EAAE,EAAEH,MAAM,CAACG;AAAZ,KAAb,CAAlB;;AACA,QAAG,CAACF,KAAD,IAAU,CAACA,KAAK,CAACG,IAApB,EAAyB;AACvB,UAAIC,KAAK,GAAG,MAAM,0BAAYL,MAAM,CAACM,GAAnB,CAAlB;AACAL,MAAAA,KAAK,GAAG,MAAM,KAAKM,MAAL,CAAYP,MAAZ,CAAd;AACAC,MAAAA,KAAK,CAACO,GAAN,GAAYH,KAAZ;AACD;;AACC,WAAOJ,KAAP;AACH;;AAED,eAAaQ,mBAAb,CAAiCT,MAAjC,EAAwC;AACtC,UAAM;AAACU,MAAAA;AAAD,QAAaV,MAAnB;AACA,QAAIW,GAAG,GAAG,MAAMC,WAASC,kBAAT,CAA4BH,QAA5B,CAAhB;AACA,WAAOV,MAAM,CAAC,UAAD,CAAb;AACA,QAAIc,WAAW,GAAG,MAAMC,SAAOhB,YAAP,CAAoBC,MAApB,CAAxB;;AAEA,QAAG,CAACc,WAAW,CAACJ,QAAhB,EAAyB;AACvBI,MAAAA,WAAW,CAACJ,QAAZ,GAAuBC,GAAG,CAACK,GAA3B;AACA,YAAMF,WAAW,CAAClB,IAAZ,EAAN;AACAe,MAAAA,GAAG,CAACM,OAAJ,CAAYtB,IAAZ,CAAiBmB,WAAW,CAACE,GAA7B;AACA,YAAML,GAAG,CAACf,IAAJ,EAAN;AACD;;AAED,WAAOkB,WAAP;AACD;;AA/Be;;eAkCHvB,W","sourcesContent":["import { Source, Category } from '../'\nimport { getImageURL } from './Favicon'\n\n\nclass SourceClass {\n\n  addArticle(article){\n    this.articles.push(article);\n    this.save().then(null, e => e)\n  }\n\n  static async findOrCreate(source){\n    let found = await this.findOne({id: source.id})\n    if(!found || !found._doc){\n      let image = await getImageURL(source.url)\n      found = await this.create(source)\n      found.img = image\n    }\n      return found;\n  }\n\n  static async findOrCreateWithCat(source){\n    const {category} = source\n    let cat = await Category.findOrCreateByName(category)\n    delete source[\"category\"]\n    let foundSource = await Source.findOrCreate(source)\n\n    if(!foundSource.category){\n      foundSource.category = cat._id\n      await foundSource.save()\n      cat.sources.push(foundSource._id);\n      await cat.save()\n    }\n\n    return foundSource\n  }\n}\n\nexport default SourceClass\n"],"file":"Source.js"}