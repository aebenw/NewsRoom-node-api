{"version":3,"sources":["../../../server/models/classes/Article.js"],"names":["ArticleClass","findOrCreate","data","article","findOne","title","populate","create","findOrCreateWithSource","source","id","name","Source","articleDoc","Article","addArticle","setSource","_id","save","then","e","addUser","user","foundUser","users","find","follower","push"],"mappings":";;;;;;;AAAA;;AAEA,MAAMA,YAAN,CAAmB;AAEjB,eAAaC,YAAb,CAA0BC,IAA1B,EAA+B;AAC7B,QAAIC,OAAO,GAAG,MAAM,KAAKC,OAAL,CAAa;AAACC,MAAAA,KAAK,EAAEH,IAAI,CAACG;AAAb,KAAb,EAAkCC,QAAlC,CAA2C,QAA3C,EAAqD,MAArD,CAApB;;AACA,QAAG,CAACH,OAAJ,EAAY;AACVA,MAAAA,OAAO,GAAG,MAAM,KAAKI,MAAL,CAAYL,IAAZ,CAAhB;AACD;;AACD,WAAOC,OAAP;AACD;;AAED,eAAaK,sBAAb,CAAoCL,OAApC,EAA4C;AAC1C,QAAI;AAAEM,MAAAA,MAAM,EAAE;AAACC,QAAAA,EAAD;AAAKC,QAAAA;AAAL;AAAV,QAAwBR,OAA5B;AACA,QAAIM,MAAM,GAAG,MAAMG,aAAOR,OAAP,CAAe;AAACM,MAAAA,EAAD;AAAKC,MAAAA;AAAL,KAAf,CAAnB;AACA,WAAOR,OAAO,CAAC,QAAD,CAAd;AAEA,QAAIU,UAAU,GAAG,MAAMC,cAAQb,YAAR,CAAqBE,OAArB,CAAvB;;AACA,QAAGM,MAAM,IAAI,CAACI,UAAU,CAACJ,MAAzB,EAAiC;AAC7B,YAAMA,MAAM,CAACM,UAAP,CAAkBF,UAAlB,CAAN;AACAA,MAAAA,UAAU,CAACG,SAAX,CAAqBP,MAArB;AACH;;AACDI,IAAAA,UAAU,GAAG,MAAMA,UAAU,CAACP,QAAX,CAAoB,QAApB,EAA8B,MAA9B,CAAnB;AACA,WAAOO,UAAP;AACD,GAtBgB,CAwBjB;AACA;AACA;AACA;;;AAEAG,EAAAA,SAAS,CAAC;AAACC,IAAAA,GAAD;AAAMN,IAAAA;AAAN,GAAD,EAAa;AAClB,SAAKF,MAAL,GAAc;AAACQ,MAAAA,GAAD;AAAMN,MAAAA;AAAN,KAAd;AACA,SAAKO,IAAL,GAAYC,IAAZ,CAAiB,IAAjB,EAAuBC,CAAC,IAAIA,CAA5B;AACH;;AAEDC,EAAAA,OAAO,CAACC,IAAD,EAAM;AACX,QAAIC,SAAS,GAAG,KAAKC,KAAL,CAAWC,IAAX,CAAgBC,QAAQ,IAAKA,QAAQ,CAAChB,EAAT,KAAgBY,IAAI,CAACZ,EAAlD,CAAhB;;AACA,QAAG,CAACa,SAAJ,EAAc;AACZ,WAAKC,KAAL,CAAWG,IAAX,CAAgBL,IAAhB;AACD;AACF;;AAvCgB;;eA0CJtB,Y","sourcesContent":["import { Article, Source } from '../news'\n\nclass ArticleClass {\n\n  static async findOrCreate(data){\n    let article = await this.findOne({title: data.title}).populate('source', 'name')\n    if(!article){\n      article = await this.create(data)\n    }\n    return article\n  }\n\n  static async findOrCreateWithSource(article){\n    let { source: {id, name}} = article\n    let source = await Source.findOne({id, name});\n    delete article[\"source\"]\n\n    let articleDoc = await Article.findOrCreate(article);\n    if(source && !articleDoc.source) {\n        await source.addArticle(articleDoc);\n        articleDoc.setSource(source);\n    }\n    articleDoc = await articleDoc.populate('source', 'name')\n    return articleDoc\n  }\n\n  // setSource(source){\n  //     this.source = source;\n  //     this.save().then(null, e => e)\n  // }\n\n  setSource({_id, name}){\n      this.source = {_id, name};\n      this.save().then(null, e => e)\n  }\n\n  addUser(user){\n    let foundUser = this.users.find(follower =>  follower.id === user.id)\n    if(!foundUser){\n      this.users.push(user)\n    }\n  }\n}\n\nexport default ArticleClass\n"],"file":"Article.js"}