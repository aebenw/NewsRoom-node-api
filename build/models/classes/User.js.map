{"version":3,"sources":["../../../server/models/classes/User.js"],"names":["UserClass","generateAuthToken","access","token","jwt","sign","_id","toHexString","toString","tokens","push","save","then","findByToken","decoded","verify","e","user","User","findOne"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,SAAN,CAAgB;AAGdC,EAAAA,iBAAiB,GAAE;AACjB,UAAMC,MAAM,GAAG,MAAf;;AACA,UAAMC,KAAK,GAAGC,sBAAIC,IAAJ,CAAS;AAACC,MAAAA,GAAG,EAAE,KAAKA,GAAL,CAASC,WAAT,EAAN;AAA8BL,MAAAA;AAA9B,KAAT,EAAgD,QAAhD,EAA0DM,QAA1D,EAAd;;AAEA,SAAKC,MAAL,CAAYC,IAAZ,CAAiB;AAACR,MAAAA,MAAD;AAASC,MAAAA;AAAT,KAAjB;AAEA,WAAO,KAAKQ,IAAL,GAAYC,IAAZ,CAAiB,MAAM;AAC5B,aAAOT,KAAP;AACD,KAFM,CAAP;AAGD;;AAED,eAAaU,WAAb,CAAyBV,KAAzB,EAA+B;AAC7B,QAAIW,OAAJ;;AAEA,QAAI;AACFA,MAAAA,OAAO,GAAGV,sBAAIW,MAAJ,CAAWZ,KAAX,EAAkB,QAAlB,CAAV;AACD,KAFD,CAEE,OAAOa,CAAP,EAAU;AAEV,aAAOA,CAAP;AACD;;AAED,QAAIC,IAAI,GAAG,MAAMC,OAAKC,OAAL,CAAa;AAC5B,aAAOL,OAAO,CAACR,GADa;AAE5B,sBAAgBH,KAFY;AAG5B,uBAAiB;AAHW,KAAb,CAAjB;AAKA,WAAOc,IAAP;AACD;;AA9Ba;;eAiCDjB,S","sourcesContent":["import { User } from '../'\nimport jwt from 'jsonwebtoken'\n\nclass UserClass {\n\n\n  generateAuthToken(){\n    const access = 'auth';\n    const token = jwt.sign({_id: this._id.toHexString(), access}, 'abc123').toString();\n\n    this.tokens.push({access, token});\n\n    return this.save().then(() => {\n      return token;\n    });\n  }\n\n  static async findByToken(token){\n    let decoded;\n\n    try {\n      decoded = jwt.verify(token, 'abc123');\n    } catch (e) {\n\n      return e;\n    }\n\n    let user = await User.findOne({\n      '_id': decoded._id,\n      'tokens.token': token,\n      'tokens.access': 'auth'\n    });\n    return user\n  }\n}\n\nexport default UserClass\n"],"file":"User.js"}